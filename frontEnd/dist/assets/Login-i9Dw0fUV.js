import{u as H,r as c,M as q,f as V,a as A,b as _,c as W,R as g,B as M,C as Y,d as z,g as Q,e as J,p as D,P as F,h as K,i as X,j as a,k as Z,l as ee,m as te,n as se,s as oe,o as re,N as L,q as P,T as ae,G as ne,t as ce,I as ie,v as x}from"./index-qNZksdZT.js";import{S as le,a as de}from"./axios-jL_M4mp6.js";function ue(s,e){return H("(prefers-color-scheme: dark)",s==="dark",e)?"dark":"light"}function me(s,e){const[t,o]=c.useState(!1),r=c.useRef(),i=c.useRef();c.useEffect(()=>{i.current=s},[s]);const d=()=>{o(n=>(!n&&!r.current&&(r.current=window.setInterval(i.current,e)),!0))},l=()=>{o(!1),window.clearInterval(r.current),r.current=void 0};return{start:d,stop:l,toggle:()=>{t?l():d()},active:t}}function O(){const s=document.createElement("style");return s.innerHTML="*, *::before, *::after {transition: none !important;}",s.setAttribute("data-mantine-disable-transition","true"),document.head.appendChild(s),()=>document.querySelectorAll("[data-mantine-disable-transition]").forEach(t=>t.remove())}function ge({keepTransitions:s}={}){const e=c.useRef(),t=c.useRef(),o=c.useContext(q);if(!o)throw new Error("[@mantine/core] MantineProvider was not found in tree");const r=n=>{o.setColorScheme(n),e.current=s?()=>{}:O(),window.clearTimeout(t.current),t.current=window.setTimeout(()=>{var p;(p=e.current)==null||p.call(e)},10)},i=()=>{o.clearColorScheme(),e.current=s?()=>{}:O(),window.clearTimeout(t.current),t.current=window.setTimeout(()=>{var n;(n=e.current)==null||n.call(e)},10)},d=ue("light",{getInitialValueInEffect:!1}),l=o.colorScheme==="auto"?d:o.colorScheme,f=c.useCallback(()=>r(l==="light"?"dark":"light"),[r,l]);return c.useEffect(()=>()=>{var n;(n=e.current)==null||n.call(e),window.clearTimeout(t.current)},[]),{colorScheme:o.colorScheme,setColorScheme:r,clearColorScheme:i,toggleColorScheme:f}}var $={root:"m-66836ed3","root--filled":"m-12b2e6d5","root--white":"m-cffd1856",wrapper:"m-a5d60502",body:"m-667c2793",title:"m-6a03f287",label:"m-698f4f23",icon:"m-667f2a6a",message:"m-7fa78076",closeButton:"m-87f54839"};const he={},fe=z((s,{radius:e,color:t,variant:o,autoContrast:r})=>{const i=s.variantColorResolver({color:t||s.primaryColor,theme:s,variant:o||"light",autoContrast:r});return{root:{"--alert-radius":e===void 0?void 0:Q(e),"--alert-bg":t||o?i.background:void 0,"--alert-color":i.color,"--alert-bd":t||o?i.border:void 0}}}),j=V((s,e)=>{const t=A("Alert",he,s),{classNames:o,className:r,style:i,styles:d,unstyled:l,vars:f,radius:n,color:p,title:u,children:b,id:C,icon:S,withCloseButton:h,onClose:E,closeButtonLabel:y,variant:m,autoContrast:w,...U}=t,v=_({name:"Alert",classes:$,props:t,className:r,style:i,classNames:o,styles:d,unstyled:l,vars:f,varsResolver:fe}),R=W(C),T=u&&`${R}-title`||void 0,B=`${R}-body`;return g.createElement(M,{id:R,...v("root",{variant:m}),variant:m,ref:e,...U,role:"alert","aria-describedby":B,"aria-labelledby":T},g.createElement("div",{...v("wrapper")},S&&g.createElement("div",{...v("icon")},S),g.createElement("div",{...v("body")},u&&g.createElement("div",{...v("title"),"data-with-close-button":h||void 0},g.createElement("span",{id:T,...v("label")},u)),b&&g.createElement("div",{id:B,...v("message")},b)),h&&g.createElement(Y,{...v("closeButton"),onClick:E,variant:"transparent",size:16,iconSize:16,"aria-label":y,unstyled:l})))});j.classes=$;j.displayName="@mantine/core/Alert";const[pe,ve]=J("Card component was not found in tree");var N={root:"m-e615b15f",section:"m-599a2148"};const be={},I=D((s,e)=>{const t=A("CardSection",be,s),{classNames:o,className:r,style:i,styles:d,vars:l,withBorder:f,inheritPadding:n,...p}=t,u=ve();return g.createElement(M,{ref:e,mod:{"with-border":f,"inherit-padding":n},...u.getStyles("section",{className:r,style:i,styles:d,classNames:o}),...p})});I.classes=N;I.displayName="@mantine/core/CardSection";const ye={},Ce=z((s,{padding:e})=>({root:{"--card-padding":K(e)}})),k=D((s,e)=>{const t=A("Card",ye,s),{classNames:o,className:r,style:i,styles:d,unstyled:l,vars:f,children:n,padding:p,...u}=t,b=_({name:"Card",props:t,classes:N,className:r,style:i,classNames:o,styles:d,unstyled:l,vars:f,varsResolver:Ce}),C=c.Children.toArray(n),S=C.map((h,E)=>typeof h=="object"&&h&&"type"in h&&h.type===I?c.cloneElement(h,{"data-first-section":E===0||void 0,"data-last-section":E===C.length-1||void 0}):h);return g.createElement(pe,{value:{getStyles:b}},g.createElement(F,{ref:e,unstyled:l,...b("root"),...u},S))});k.classes=N;k.displayName="@mantine/core/Card";k.Section=I;var Se=X("alert-circle","IconAlertCircle",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 8v4",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);let G="http://localhost:3000/api/";G="/api/";const Ee=G+"auth/google-login";class we extends g.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return console.log(e),{hasError:!0}}componentDidCatch(e,t){console.info(e,t)}render(){return this.state.hasError?a.jsx(j,{color:"red",variant:"light",children:"Something went wrong.."}):this.props.children}}const xe=we,ke=10;function Re(){const s=Z(),e=ee(),t=s.search.substring(6).trim(),[o,r]=c.useState(!1),[i,d]=c.useState(!1),[l,f]=te(),[n,p]=c.useState(ke),u=me(()=>p(y=>y-1),1e3),b=se(oe),C=re(),{colorScheme:S}=ge(),h=S==="dark";c.useEffect(()=>{s.search.includes("logout=true")&&(d(!0),l.delete("next"),l.delete("logout"),f(l))},[]),c.useEffect(()=>(o&&u.start(),()=>u.stop()),[o]),c.useEffect(()=>{n===0&&(u.stop(),u.active=!1,e("/"))},[n]);const E=async y=>{try{const m=y.credential,w=await de.post(Ee,{tokenId:m});if(w.status===200||w.status===201)return C(ie({token:w.data.token,uuid:w.data.data.user.id})),x({title:"Success",message:"You have successfully logged in",color:"green"}),e(t!==null&&t!==""?t:"/");w.status===403?x({title:"Forbidden",message:"Disabled by Admin",color:"orange"}):x({title:"Error",message:"Something went wrong",color:"red"})}catch(m){if(m.response.status===404&&m.response.data.status==="USER_NOT_FOUND"){if(t&&t!==""){e("/signup?next="+t,{state:{...m.response.data}});return}e("/signup",{state:{...m.response.data}}),x({title:"Oh no!",message:"Looks like you don't have an account",color:"orange"})}else m.response.status===403?(r(!0),x({title:"Forbidden",message:"Disabled by Admin",color:"orange"})):(x({color:"red",title:"Hey !!",message:m.response.data.message,autoClose:!1}),console.error("THIS IS THE ERROR",m))}finally{}};return b?t!==null&&t!==""?a.jsx(L,{to:t}):a.jsx(L,{to:"/"}):a.jsxs("div",{children:[i===!0&&a.jsx(j,{styles:{message:{fontSize:"1.2em"},title:{fontSize:"1.4em"}},radius:"xs",icon:a.jsx(Se,{size:25}),title:"Logged Out!",color:"orange",withCloseButton:!0,onClose:()=>d(!1),children:"You've been successfully logged out."}),a.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundImage:'url("./static/images/NewLogin2.webp")',backgroundSize:"cover",backgroundPosition:"center"},children:a.jsxs(k,{shadow:"md",p:"lg",radius:"sm",withBorder:!0,children:[a.jsx(k.Section,{withBorder:!0,inheritPadding:!0,children:a.jsx(P,{children:a.jsx(ae,{size:"sm",m:"lg",children:a.jsx(ne,{children:"Welcome back !"})})})}),a.jsx("br",{}),a.jsx(P,{children:a.jsx(le,{align:"center",m:"lg",children:a.jsx(xe,{children:a.jsx(ce,{width:275,shape:"rectangular",useOneTap:!0,theme:h?"filled_black":"filled_blue",onSuccess:async y=>{await E(y)},onError:()=>{console.log("Login Failed")}})})})}),a.jsx("br",{})]})})]})}export{Re as default};
